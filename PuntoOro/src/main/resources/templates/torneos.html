<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneos - Punto de Oro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/torneos.css}" type="text/css">
    <script th:src="@{/js/torneos.js}" defer></script>
</head>

<body>
    <header>
        <nav class="header-container">
            <ul class="left-content">
                <li  class="header-logo">
                    <a th:href="@{/index}">
                        <label class="title">Punto de oro</label>
                        <img class="imghead" th:src="@{/images/PelotaPadel.png}" alt="PelotaPadel">    
                    </a>
                </li>
            </ul>
            <ul class="right-content">
                <li sec:authorize="isAuthenticated()">

                </li>

                <div class="navbar">
                    <div class="red-index">
                        <a th:href="@{/index}">Inicio</a>
                    </div>
                    <div class="red-calendario">
                        <a th:href="@{/calendario}">Calendario</a>
                    </div>
                    <div class="dropdown">
                        <button class="dropbtn">
                            <i class="fa-solid fa-gear"></i>
                        </button>
                        <div class="dropdown-content">
                            <a th:href="@{/miCuenta}">Mi Cuenta</a>
                            <a th:href="@{/ranking}">Ranking</a>
                            <a th:href="@{/usuario}">Usuarios</a>
                            <a th:href="@{/canchas}">Canchas</a>
                            <a th:href="@{/jugador}">Jugador</a>
                            <a th:href="@{/torneos}">Torneos</a>
                            <a th:href="@{/logout}" method="post" type="submit">Cerrar sesión</a>
                        </div>
                    </div>
                </div>
            </ul>
            
        </nav>
    </header>

    <main>
         <!-- Contenido principal -->
        <div class="background-img-home">
            <div class="texto">
                <h1>Gestión de Torneos</h1>

                <div class="torneos-container">
                    <button class="btn-agregar" onclick="mostrarModalCrear()">Agregar Torneo</button>
                    
                    <table class="torneos-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha Inicio</th>
                                <th>Fecha Fin</th>
                                <th>Categoría</th>
                                <th>Estado</th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="torneo : ${torneos}" th:onclick="'verDetalles(' + ${torneo.id} + ')'" >
                                <td th:text="${torneo.id}"></td>
                                <td th:text="${#temporals.format(torneo.fechaInicio, 'dd/MM/yyyy')}"></td>
                                <td th:text="${#temporals.format(torneo.fechaFin, 'dd/MM/yyyy')}"></td>
                                <td th:text="${torneo.categoria != null ? torneo.categoria.categoria : 'Sin categoría'}"></td>
                                <td th:text="${torneo.estado}"></td>
                                <td>
                                    <button type="button" 
                                            th:onclick="editarTorneo([[${torneo.id}]])"
                                            data-fecha-inicio="[[${torneo.fechaInicio != null ? torneo.fechaInicio.format(T(java.time.format.DateTimeFormatter).ofPattern('dd/MM/yyyy')) : ''}]]"
                                            data-fecha-fin="[[${torneo.fechaFin != null ? torneo.fechaFin.format(T(java.time.format.DateTimeFormatter).ofPattern('dd/MM/yyyy')) : ''}]]"
                                            data-categoria="[[${torneo.categoria != null ? torneo.categoria : 'Sin categoría'}]]"
                                            data-estado="[[${torneo.estado}]]" class="btn-editar">
                                        Editar
                                    </button>
                                </td>
                                <td>
                                    <button class="btn-accion btn-eliminar" th:onclick="'eliminarTorneo(' + ${torneo.id} + ')'">Eliminar</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            
                <!-- Modal para crear/editar torneo -->
                <div id="formularioAgregar" class="form-overlay" style="display: none;">
                    <div class="form">
                        <div class="cruz" onclick="cerrarFormulario()">
                            <i class="fa-solid fa-x"></i>
                        </div>
                        <h2 id="modalTitle">Nuevo Torneo</h2>
                        <form id="form-guardar" th:action="@{/torneos/crear}" method="POST" th:object="${torneo}">
                            <input type="hidden" id="torneoId" name="id">
                            <div class="username">
                                <input type="date" id="fechaInicio" name="fechaInicio" required>
                                <label for="fechaInicio">Fecha Inicio</label>
                            </div>
                            <div class="username">
                                <label for="fechaFin">Fecha Fin</label>
                                <input type="date" id="fechaFin" name="fechaFin" required>
                            </div>
                            <div class="username">
                                <label for="categoria">Categoría</label>
                                <select id="categoria" name="idCategoria" required>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                </select>
                            </div>
                            <div class="username">
                                <label for="estado">Estado</label>
                                <select id="estado" name="estado" required>
                                    <option value="PLANIFICADO">Planificado</option>
                                    <option value="EN_CURSO">En curso</option>
                                    <option value="FINALIZADO">Finalizado</option>
                                </select>
                            </div>
                            <div class="acciones">
                                <button type="submit"  class="btn-agregar">Guardar</button>
                                <button type="button" class="btn-accion" onclick="cerrarModal()">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Modal para crear/editar torneo -->
                <!-- Modal para crear/editar torneo -->
                <div id="formularioEditarTorneo" class="form-overlay-editar" style="display: none;">
                    <div class="form">
                        <div class="cruz" onclick="cerrarFormulario()">
                            <i class="fa-solid fa-x"></i>
                        </div>
                        <h2 id="modalTitle">Editar Torneo</h2>
                        <form id="formActualizarTorneo" method="POST">
                            <input type="hidden" id="idTorneo" name="idTorneo">
                            <div class="username">
                                <label for="fechaInicioEditar">Fecha Inicio</label>
                                <input type="date" id="fechaInicioEditar" name="fechaInicio" required>
                            </div>
                            <div class="username">
                                <label for="fechaFinEditar">Fecha Fin</label>
                                <input type="date" id="fechaFinEditar" name="fechaFin" required>
                            </div>
                            <div class="username">
                                <label for="categoriaEditar">Categoría</label>
                                <select id="categoriaEditar" name="idCategoria" required>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                </select>
                            </div>
                            <div class="username">
                                <label for="estadoEditar">Estado</label>
                                <select id="estadoEditar" name="estado" required>
                                    <option value="PLANIFICADO">Planificado</option>
                                    <option value="EN_CURSO">En curso</option>
                                    <option value="FINALIZADO">Finalizado</option>
                                </select>
                            </div>
                            <div class="acciones">
                                <button type="button" onclick="guardarCambiosTorneo()" class="btn-agregar">Guardar</button>
                                <button type="button" class="btn-accion" onclick="cerrarFormulario()">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>



            </div>
        </div>
    </main>
    <footer class="site-footer">
        <div class="footer-logo" translate="no">Punto de Oro Bragado</div>
        <div class="footer-links">
            <ul>
                <a href="#" onclick=""></a>
                <a href="#" onclick=""></a>
                <a href="#" onclick=""></a>
            </ul>
        </div>
        <div class="footer-social">
            <a href="#" class="social-link"><img class="social-link-facebook" src="/images/facebook.png"></a>
            <a href="#" class="social-link"><img class="social-link-twitter" src="/images/twitter.png"></a>
            <a href="#" target="_blank" class="social-link"><img class="social-link-instgram" src="/images/instagram.png"></a>
        </div>
        <p id="Copyright">Derechos de autor &copy; 2024 Punto de Oro</p>
    </footer>
</body>
</html>
